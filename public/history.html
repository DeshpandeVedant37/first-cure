<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Patient History | First-Cure</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
<header class="glass">
  <div class="logo">
    <img src="assets/logo.png" alt="logo">
    <span>First-Cure</span>
  </div>
  <nav class="nav-sections">
    <a href="index.html" class="nav-item">Home</a>
    <a href="about.html" class="nav-item">About</a>
    <a href="contact.html" class="nav-item">Contact</a>
    <a href="history.html" class="nav-item">Patient History</a>
  </nav>
</header>

<section class="hero">
  <h1>Patient History</h1>
  <p>View all saved scan results</p>
</section>

<section class="card" style="max-width:900px">
  <div id="historyList"></div>
</section>

<footer>
  ⚠️ Educational use only. Consult a dermatologist.
</footer>

<script>
function loadHistory() {
  const history = JSON.parse(localStorage.getItem('patientHistory') || '[]');
  const historyList = document.getElementById('historyList');
  
  if (history.length === 0) {
    historyList.innerHTML = '<p style="color:#888;text-align:center">No saved results yet</p>';
    return;
  }
  
  historyList.innerHTML = history.map((record, idx) => `
    <div style="border:1px solid #ddd;padding:15px;margin:10px 0;border-radius:10px;border-left:4px solid ${record.risk === 'malignant' ? '#c92a2a' : '#2b8a3e'}">
      <div style="display:flex;justify-content:space-between;margin-bottom:10px">
        <strong>${record.patientName}</strong>
        <span style="font-size:12px;color:#666">${new Date(record.timestamp).toLocaleString()}</span>
      </div>
      <p style="margin:5px 0"><strong>Diagnosis:</strong> ${record.diagnosis} (${(record.confidence * 100).toFixed(1)}%)</p>
      ${record.notes ? `<p style="margin:5px 0;font-size:13px;color:#555"><strong>Notes:</strong> ${record.notes}</p>` : ''}
      <button onclick="deleteRecord(${idx})" style="padding:5px 15px;font-size:12px;background:#c92a2a;margin-top:8px;border:none;border-radius:5px;color:#fff;cursor:pointer">Delete</button>
    </div>
  `).join('');
}

function deleteRecord(idx) {
  const history = JSON.parse(localStorage.getItem('patientHistory') || '[]');
  history.splice(idx, 1);
  localStorage.setItem('patientHistory', JSON.stringify(history));
  loadHistory();
}

window.addEventListener('DOMContentLoaded', loadHistory);
</script>
</body>
</html>
